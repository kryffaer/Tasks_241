# Настриваем

1. Какой по умолчанию используется порт для поключения?<br />
22<br />
2. Можно ли его изменить? если да то как?<br />
* Подключаемся к серверу via SSH
```sh
ssh username@server_ip
```
* Редактируем файл конфигурации SSH
```sh
sudo nano /etc/ssh/sshd_config
```
* Находим строку #Port 22 и меняем ее на желаемый порт
```sh
Port 2222
```
* Сохраняем изменения и выходим из редактора
* Перезапускаем службу SSH
```sh
sudo systemctl restart sshd
```
3. Какая служба отвечает за обработку запросов на подключения по ssh?<br />
sshd<br />
4. Какой файл конфигурации отвечает за его настройку?<br />
/etc/ssh/ssh_config<br />
5. Попробуйте подключиться по ssh к предоставленному вам серверу<br />
```sh
ssh username@server_ip
```
6. Отредактируйте файл настроек на сервере так, чтобы была возможность подключиться к серверу используя пользователя root<br />
* Подключимся к серверу под учетной записью с правами администратора<br />
* Отредактируем файл /etc/ssh/sshd_config:<br />
```sh
sudo nano /etc/ssh/sshd_config
```
* Найдём строку PermitRootLogin и изменим ее на yes:<br />
```sh
PermitRootLogin yes
```
* Сохраним изменения и выйдем из редактора<br />
* Перезапустим службу SSH:<br />
```sh
sudo systemctl restart sshd
```
7. Измените колличество ошибок ввода пароля перед сборосом соединения, покажите эти измененения<br />
* Отредактируем файл /etc/ssh/sshd_config:<br />
```sh
sudo nano /etc/ssh/sshd_config
```
* Найдём строку MaxAuthTries и изменим ее на желаемое значение:<br />
```sh
MaxAuthTries 3
```
* Сохраним изменения и выйдем из редактора<br />
* Перезапустим службу SSH:<br />
```sh
sudo systemctl restart sshd
```
8. Создайте пользователя ssh-user и попробуйте им подключиться к серверу<br />
* Создадим пользователя:<br />
```sh
sudo useradd ssh-user
sudo passwd ssh-user
```
* Подключимся к серверу, используя нового пользователя:<br />
```sh
ssh ssh-user@server_ip
```
9. Ограничте ему возможность подключения к серверу<br />
* Отредактируем файл authorized_keys пользователя:<br />
```sh
sudo nano /home/ssh-user/.ssh/authorized_keys
```
* Добавим директиву, запрещающую вход:<br />
```sh
no-pty,no-X11-forwarding,no-agent-forwarding,no-port-forwarding,permitopen="none" ssh-rsa ...your_public_key...
```
* Сохраним изменения<br />
10. Как вы это сделали?<br />
* Изменили файл конфигурации SSH-сервера для разрешения подключения под пользователем root<br />
* Изменили количество ошибок ввода пароля<br />
* Создали нового пользователя и ограничили его доступ к серверу<br />
11. Что хранится в файле known_hosts?<br />
Файл known_hosts хранит записи о известных SSH-хостах, с которыми пользователь ранее связывался. В этом файле содержатся хеш-суммы публичных ключей этих хостов, что позволяет SSH-клиенту проверять идентичность сервера при подключении и предотвратить атаки типа "man-in-the-middle".
